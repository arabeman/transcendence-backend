# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: mrabenja <mrabenja@student.42antananari    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/12/27 16:02:14 by mrabenja          #+#    #+#              #
#    Updated: 2026/01/02 19:25:42 by mrabenja         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# Reset
Color_Off=\033[0m

# Regular Colors
Black = \e[0;30m
Red = \e[0;31m
Green = \e[0;32m
Yellow = \e[0;33m
Blue = \e[0;34m
Purple = \e[0;35m
Cyan = \e[0;36m
White = \e[0;37m

# Bold
BBlack = \e[1;30m
BRed = \e[1;31m
BGreen = \e[1;32m
BYellow = \e[1;33m
BBlue = \e[1;34m
BPurple = \e[1;35m
BCyan = \e[1;36m
BWhite = \e[1;37m

# Background
On_Black = \e[40m
On_Red = \e[41m
On_Green = \e[42m
On_Yellow = \e[43m
On_Blue = \e[44m
On_Purple = \e[45m
On_Cyan = \e[46m
On_White = \e[47m


define _STD_NAME
⠀⠀⠀⠀⣀⣀⣤⣤⣤⣄⣀⡀⠀⠀⠀⠀⠀⢀⣀⣀⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀
⠀⣠⠶⠚⠉⠉⠀⠀⠀⣈⡉⠙⠳⢦⡴⠖⠚⠉⠉⠉⠉⠉⠙⠲⣤⡀⠀⠀⠀⠀
⠊⠁⠀⠀⠀⠀⠀⣀⠭⠛⠛⣛⠳⣶⣤⡀⠀⠀⠀⠀⠀⣠⣴⠶⡛⢛⠻⢦⣀⠀
⠀⠀⠀⠠⠤⠤⡜⣡⣴⣿⣿⣿⠟⠁⢹⡿⢦⠀⠀⢠⠊⣻⣷⣿⣿⠟⠉⢰⡌⢳
⠉⠐⠒⠦⢤⣸⠀⣿⣿⣿⠟⠁⢀⣴⣿⣿⢸⠒⠒⡇⢸⣿⣿⡿⠃⠀⣠⣿⣿⠀
⠀⠀⠀⠀⠀⠘⢄⠻⣿⠁⢀⡠⣪⣿⣿⠏⡼⠁⠀⢣⠈⢿⠟⠁⢠⢮⣾⣿⠟⢠
⠀⠀⠀⣠⠤⠤⣌⠑⠤⣁⣋⣋⣉⣁⠴⠊⠀⣀⣀⣀⡑⠤⣁⠒⠳⠛⢋⣁⢴⠋
⠀⠀⠀⢻⣴⠰⣌⠓⠦⢤⣀⣀⣶⣤⣤⣶⣿⣿⡿⣿⣿⣶⣤⣬⣽⠉⠁⠀⢸⡗
⠀⠀⠀⠀⠙⠶⣄⣁⠒⠀⠤⠀⠈⣙⡛⠛⠛⠛⠛⠛⠛⠛⠟⠛⠛⠉⠉⣉⣹⡇
⣿⣷⣶⣦⣤⣤⣄⣈⣉⠉⠙⠒⠒⠒⠦⠤⠤⠤⠤⠤⠤⠤⠤⡤⣤⠤⣖⡶⠟⠁
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣤⣤⣤⣤⣤⣤⡤⠚⠉⡠⠴⡯⠤⣄⠀
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠋⠀⠀⠈⠑⠀⢋⠔⠛⣦
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣄⠀⠀⠀⠤⠤⠢⠀⠀⠊⣽
⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣀⣠⠋⠑⠉⡍⢱⣉⠞⠁
								   
endef	
export _STD_NAME


define	_BUILT_START
██████╗ ██╗   ██╗██╗██╗  ████████╗       ██╗              
██╔══██╗██║   ██║██║██║  ╚══██╔══╝       ██║              
██████╔╝██║   ██║██║██║     ██║       ████████╗           
██╔══██╗██║   ██║██║██║     ██║       ██╔═██╔═╝           
██████╔╝╚██████╔╝██║███████╗██║       ██████║             
╚═════╝  ╚═════╝ ╚═╝╚══════╝╚═╝       ╚═════╝             
														  
███████╗████████╗ █████╗ ██████╗ ████████╗███████╗██████╗ 
██╔════╝╚══██╔══╝██╔══██╗██╔══██╗╚══██╔══╝██╔════╝██╔══██╗
███████╗   ██║   ███████║██████╔╝   ██║   █████╗  ██║  ██║
╚════██║   ██║   ██╔══██║██╔══██╗   ██║   ██╔══╝  ██║  ██║
███████║   ██║   ██║  ██║██║  ██║   ██║   ███████╗██████╔╝
╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   ╚══════╝╚═════╝ 
																											
endef
export _BUILT_START

define _UP
██╗   ██╗██████╗ 
██║   ██║██╔══██╗
██║   ██║██████╔╝
██║   ██║██╔═══╝ 
╚██████╔╝██║     
 ╚═════╝ ╚═╝     
				 
endef
export _UP

define _REBUILT
██████╗ ███████╗██████╗ ██╗   ██╗██╗██╗  ████████╗
██╔══██╗██╔════╝██╔══██╗██║   ██║██║██║  ╚══██╔══╝
██████╔╝█████╗  ██████╔╝██║   ██║██║██║     ██║   
██╔══██╗██╔══╝  ██╔══██╗██║   ██║██║██║     ██║   
██║  ██║███████╗██████╔╝╚██████╔╝██║███████╗██║   
╚═╝  ╚═╝╚══════╝╚═════╝  ╚═════╝ ╚═╝╚══════╝╚═╝   
                                                  
endef
export _REBUILT

define _DOWN
██████╗  ██████╗ ██╗    ██╗███╗   ██╗
██╔══██╗██╔═══██╗██║    ██║████╗  ██║
██║  ██║██║   ██║██║ █╗ ██║██╔██╗ ██║
██║  ██║██║   ██║██║███╗██║██║╚██╗██║
██████╔╝╚██████╔╝╚███╔███╔╝██║ ╚████║
╚═════╝  ╚═════╝  ╚══╝╚══╝ ╚═╝  ╚═══╝
									 
endef
export _DOWN

define _WIPE

██╗    ██╗██╗██████╗ ███████╗██████╗ 
██║    ██║██║██╔══██╗██╔════╝██╔══██╗
██║ █╗ ██║██║██████╔╝█████╗  ██║  ██║
██║███╗██║██║██╔═══╝ ██╔══╝  ██║  ██║
╚███╔███╔╝██║██║     ███████╗██████╔╝
 ╚══╝╚══╝ ╚═╝╚═╝     ╚══════╝╚═════╝ 
                                     



⣿⣿⣿⣿⣿⡿⠛⠋⠁⠀⠀⠀⠀⠙⠛⠿⠟⠋⠉⠁⠀⠈⠙⠻⣿⣿⣿⣿⣿⣿
⣿⣿⣿⡿⠋⠀⠸⠄⢀⣀⠠⠤⠤⣀⡀⠐⡄⠀⠀⠀⠀⠀⠾⠂⠈⠻⣿⣿⣿⣿
⣿⣿⡟⠀⠀⠀⠠⠋⠁⠀⠀⠀⠀⠀⠉⠙⠻⠒⠚⠛⠛⠛⠛⠒⠒⠦⠘⢿⣿⣿
⣿⠟⠀⠀⡆⠀⠀⠀⠀⢀⣤⣴⣶⣶⣶⣶⣶⣧⣄⢀⣠⣤⣤⣶⣶⣶⣤⣤⣙⢿
⠁⢸⠀⠸⠅⠀⠀⣴⣾⣿⣿⣿⣿⣿⡏⡉⠙⣿⣿⣼⣿⣿⣿⣿⣿⢋⡉⢻⣿⡆
⣀⠀⠀⠀⠀⠀⠀⠀⢉⠛⠿⢿⣿⣿⣷⣧⣶⡿⠟⠸⠿⠿⣿⡿⠿⠶⠬⠾⠿⢃
⠓⠀⠀⠀⠀⠀⠀⠀⠈⠙⠒⠤⠤⠬⠭⠁⣤⠤⠖⠁⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠠⠔⠊⠁⠀⠀⠀⠑⠢⡄⠒⠒⠂⠰⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢿⣿
⠀⠀⠀⠀⠀⠀⠀⣀⣤⣤⣤⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡈⣿
⠀⠀⠀⠀⠀⠀⣼⣿⣧⣭⣭⣍⣛⣛⣛⡶⠶⠶⢦⣤⣤⣤⣤⣤⣴⣶⠿⠛⣡⣿
⠀⠀⠀⠀⠰⢄⠈⠉⠉⠉⠉⠉⠉⠙⠛⠛⠿⠿⠿⠷⠶⠶⣶⣶⣶⡶⢟⣸⣿⣿
⣄⣀⡀⠀⠀⠀⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣴⣿⣿⣿⣿⣿
⠀⠀⠈⠉⠓⠒⠢⠤⠤⠤⠤⣤⣤⣤⣤⠤⠄⠀⠀⠀⢴⣶⣿⣿⣿⣿⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢻⣿⣿⣿⣿⣿⣿⣿
endef
export _WIPE


# Default compose file
COMPOSE_FILE = ./docker-compose.yml


all:
	@clear
	@echo "$(BGreen)"
	@echo "$$_STD_NAME"
	@echo "$(Color_Off)"
	@# --- Setup Script ---
	@chmod +x ./scripts/setup_secrets.sh
	@./scripts/setup_secrets.sh
	@# ---------------------
	docker compose -f $(COMPOSE_FILE) up -d --build
	@echo "$(BGreen)"
	@echo "$$_BUILT_START"
	@echo "$(Color_Off)"


up:
	@clear
	@# --- Setup Script ---
	@chmod +x ./scripts/setup_secrets.sh
	@./scripts/setup_secrets.sh
	@# ---------------------
	docker compose -f $(COMPOSE_FILE) up -d
	@echo "$(BCyan)"
	@echo "$$_UP"
	@echo "$(Color_Off)"

rebuild:
	@clear
	@# --- Setup Script ---
	@chmod +x ./scripts/setup_secrets.sh
	@./scripts/setup_secrets.sh
	@# ---------------------
	docker compose -f $(COMPOSE_FILE) up -d --build
	@echo "$(BBlue)"
	@echo "$$_REBUILT"
	@echo "$(Color_Off)"
	
down:
	@clear
	docker compose -f $(COMPOSE_FILE) down
	@echo "$(BYellow)"
	@echo "$$_DOWN"
	@echo "$(Color_Off)"

wipe:
	@clear
	docker compose -f $(COMPOSE_FILE) down --volumes --rmi all --remove-orphans
	@rm -rf .env
	@clear
	@echo "$(BPurple)"
	@echo "$$_WIPE"
	@echo "$(Color_Off)"

re: wipe all
	

.PHONY: all up down wipe re